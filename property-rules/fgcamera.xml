<PropertyList>

	<params include="params.xml"/>

	<filter>
		<type>gain</type>
		<input>
			<condition>
				<property>/sim/fgcamera/dialogs/RND/edit-mode</property>
				<not>
					<property>/sim/fgcamera/dialogs/RND/profile</property>
				</not>
			</condition>
			<value>1</value>
		</input>
		<input>
			<condition>
				<property>/sim/fgcamera/dialogs/RND/edit-mode</property>
				<property>/sim/fgcamera/dialogs/RND/profile</property>
			</condition>
			<value>0</value>
		</input>
		<input>
			<condition>
				<or>
					<property>/gear/gear/wow</property>
					<property>/gear/gear[1]/wow</property>
					<property>/gear/gear[2]/wow</property>
					<property>/gear/gear[3]/wow</property>
					<property>/gear/gear[4]/wow</property>
					<property>/gear/gear[5]/wow</property>
					<property>/gear/gear[6]/wow</property>
				</or>
			</condition>
			<value>1</value>
		</input>
		<input>0</input>
		<output>/sim/fgcamera/state/wow</output>
	</filter>

<!--
===================================================================================================
	Random number generator
===================================================================================================
-->
	<filter>
		<type>gain</type>
		<input>
			<expression>
				<mod>
					<sum>
						<product>
							<value>1103515245</value>
							<property alias="/params/_rand"/>
						</product>
						<value>12345</value>
					</sum>
					<pow>
						<value>2</value>
						<value>31</value>
					</pow>
				</mod>
			</expression>
		</input>
		<output alias="/params/_rand"/>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<expression>
				<product>
					<property alias="/params/_rand"/>
					<pow>
						<value>2</value>
						<value>-31</value>
					</pow>
				</product>
			</expression>
		</input>
		<output alias="/params/rand"/>
	</filter>
<!--
===================================================================================================
	Mouse Look
===================================================================================================
-->
<!-- FIX: disable all the filters when mouse look is not in use -->
	<filter>
		<type>gain</type>
		<input>
			<expression>
				<difference>
					<property alias="/params/mlook/raw/h"/>
					<property alias="/params/mlook/delta-x"/>
				</difference>
			</expression>
		</input>
		<output>
			<property alias="/params/mlook/raw/h"/>
		</output>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property alias="/params/mlook/raw/p"/>
					<property alias="/params/mlook/delta-y"/>
				</sum>
			</expression>
		</input>
		<output>
			<property alias="/params/mlook/raw/p"/>
		</output>
	</filter>

	<filter> <!-- ? (check mice.xml) -->
		<type>gain</type>
		<input>0</input>
		<output alias="/params/mlook/delta-x"/>
		<output alias="/params/mlook/delta-y"/>
	</filter>
<!--
	Filter/scale mouse-look offsets:
-->
	<filter>
		<type>exponential</type>
		<gain>
			<property alias="/params/mlook/sensitivity"/>
		</gain>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/mlook/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property alias="/params/mlook/raw/h"/>
		</input>
		<output>
			<property alias="/params/mlook/h"/>
		</output>
	</filter>

	<filter>
		<type>exponential</type>
		<gain>
			<property alias="/params/mlook/sensitivity"/>
		</gain>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/mlook/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property alias="/params/mlook/raw/p"/>
		</input>
		<output>
			<property alias="/params/mlook/p"/>
		</output>
	</filter>

<!--
===================================================================================================
	View adjustment:

		1. Transform velocities (V_x ,V_y , V_z) to global coordinate system (using gain filters);
		2. ...
		3. ...

===================================================================================================
-->
	<filter>
		<!--
			Calculate scale for "World camera" (used to convert linear velocity to angular velocity)
		-->
		<type>gain</type>
		<enable>
			<!--
				Enable if world camera is selected
				(camera-type = 2)
			-->
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
		</enable>
		<input>
			<expression>
				<pow>
					<sum>
						<product> <!-- ft2m -->
							<property alias="/params/adjustment/raw/alt"/>
							<value>0.3048</value>
						</product>
						<value>6371000</value> <!-- Earth radius [m] -->
					</sum>
					<value>-1</value>
				</pow>
			</expression>
		</input>
		<output>/world-camera/velocity-scale</output>
	</filter>

	<filter>
		<!--
			transform V_x
		-->
		<type>gain</type>
		<gain>
			<property alias="/params/adjustment/v-linear"/>
		</gain>
		<input>
			<expression>
				<sum>
					<product>
						<cos>
							<deg2rad>
								<property>/sim/current-view/heading-offset-deg</property>
							</deg2rad>
						</cos>
						<property>/sim/fgcamera/view-adjustment/raw/x-velocity</property>
					</product>
					<product>
						<sin>
							<deg2rad>
								<property>/sim/current-view/heading-offset-deg</property>
							</deg2rad>
						</sin>
						<cos>
							<deg2rad>
								<property>/sim/current-view/pitch-offset-deg</property>
							</deg2rad>
						</cos>
						<property>/sim/fgcamera/view-adjustment/raw/z-velocity</property>
					</product>
					<product>
						<sin>
							<deg2rad>
								<property>/sim/current-view/heading-offset-deg</property>
							</deg2rad>
						</sin>
						<sin>
							<deg2rad>
								<property>/sim/current-view/pitch-offset-deg</property>
							</deg2rad>
						</sin>
						<property>/sim/fgcamera/view-adjustment/raw/y-velocity</property>
					</product>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/view-adjustment/rotated/x-velocity</output>
	</filter>

	<filter>
		<!--
			transform V_y
		-->
		<type>gain</type>
		<gain>
			<property alias="/params/adjustment/v-linear"/>
		</gain>
		<input>
			<expression>
				<difference>
					<product>
						<cos>
							<deg2rad>
								<property>/sim/current-view/pitch-offset-deg</property>
							</deg2rad>
						</cos>
						<property>/sim/fgcamera/view-adjustment/raw/y-velocity</property>
					</product>
					<product>
						<sin>
							<deg2rad>
								<property>/sim/current-view/pitch-offset-deg</property>
							</deg2rad>
						</sin>
						<property>/sim/fgcamera/view-adjustment/raw/z-velocity</property>
					</product>
				</difference>
			</expression>
		</input>
		<output>/sim/fgcamera/view-adjustment/rotated/y-velocity</output>
	</filter>

	<filter>
		<!--
			transform V_z
		-->
		<type>gain</type>
		<gain>
			<property alias="/params/adjustment/v-linear"/>
		</gain>
		<input>
			<expression>
				<sum>
					<product>
						<product>
							<sin>
								<deg2rad>
									<property>/sim/current-view/heading-offset-deg</property>
								</deg2rad>
							</sin>
							<value>-1</value>
						</product>
						<property>/sim/fgcamera/view-adjustment/raw/x-velocity</property>
					</product>
					<product>
						<cos>
							<deg2rad>
								<property>/sim/current-view/heading-offset-deg</property>
							</deg2rad>
						</cos>
						<cos>
							<deg2rad>
								<property>/sim/current-view/pitch-offset-deg</property>
							</deg2rad>
						</cos>
						<property>/sim/fgcamera/view-adjustment/raw/z-velocity</property>
					</product>
					<product>
						<cos>
							<deg2rad>
								<property>/sim/current-view/heading-offset-deg</property>
							</deg2rad>
						</cos>
						<sin>
							<deg2rad>
								<property>/sim/current-view/pitch-offset-deg</property>
							</deg2rad>
						</sin>
						<property>/sim/fgcamera/view-adjustment/raw/y-velocity</property>
					</product>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/view-adjustment/rotated/z-velocity</output>
	</filter>
<!--
	calculate h-velocity if "look-at" mode is activated
-->
	<!--filter>
		<type>gain</type>
		<enable>
			<property>/fgcam/look-at</property>
		</enable>
		<input>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
			<expression>
				<rad2deg>
					<atan2>
						<difference>
							<property>/position/longitude-deg</property>
							<property>/sim/fgcamera/current-camera/longitude-deg</property>
						</difference>
						<difference>
							<property>/position/latitude-deg</property>
							<property>/sim/fgcamera/current-camera/latitude-deg</property>
						</difference>
					</atan2>
				</rad2deg>
			</expression>
		</input>
		<input>
			<expression>
				<rad2deg>
					<atan2>	
						<product>
							<property>/sim/current-view/x-offset-m</property>
							<value>1</value>
						</product>
						<property>/sim/current-view/z-offset-m</property>
					</atan2>
				</rad2deg>
			</expression>
		</input>
		<output>/fgcam/hdg</output>
	</filter-->
<!--
	Calculate raw offsets (x-offset-m, y-offset-m, z-offset-m):
-->
	<filter>
		<!--
			raw x-offset-m
		-->
		<type>gain</type>
		<input>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
			<value>0</value>
		</input>
		<input>
			<expression>
				<sum>
					<product>
						<property>/sim/fgcamera/view-adjustment/rotated/x-velocity</property>
						<property alias="/params/state/delta-t"/>
					</product>
					<property>/sim/fgcamera/view-adjustment/raw/x-offset-m</property>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/view-adjustment/raw/x-offset-m</output>
	</filter>

	<filter> <!-- "World camera" (camera-type = 2) -->
		<type>gain</type>
		<enable>
			<equals>
				<property alias="/params/camera-type"/>
				<value>2</value>
			</equals>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<rad2deg>
							<product>
								<property>/sim/fgcamera/view-adjustment/rotated/x-velocity</property>
								<property>/world-camera/velocity-scale</property>
							</product>
						</rad2deg>
						<property>/sim/time/delta-realtime-sec</property>
						<pow>
							<product>
								<cos>
									<deg2rad>
										<property alias="/params/movement/cfg/lat"/>
									</deg2rad>
								</cos>
								<value>6371</value>
							</product>
							<value>-1</value>
						</pow>
						<value>6371</value>
					</product>
					<property alias="/params/adjustment/raw/lon"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/adjustment/raw/lon"/>
	</filter>
<!--
=================================================
-->
	<filter>
		<!--
			raw y-offset-m
		-->
		<type>gain</type>
		<input>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
			<value>0</value>
		</input>
		<input>
			<expression>
				<sum>
					<product>
						<property>/sim/fgcamera/view-adjustment/rotated/y-velocity</property>
						<property alias="/params/state/delta-t"/>
					</product>
					<property>/sim/fgcamera/view-adjustment/raw/y-offset-m</property>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/view-adjustment/raw/y-offset-m</output>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<equals>
				<property alias="/params/camera-type"/>
				<value>2</value>
			</equals>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property>/sim/fgcamera/view-adjustment/rotated/y-velocity</property>
						<property>/sim/time/delta-realtime-sec</property>
						<value>3.28083</value>
					</product>
					<property alias="/params/adjustment/raw/alt"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/adjustment/raw/alt"/>
	</filter>
<!--
=================================================
-->
	<filter>
		<!--
			raw z-offset-m
		-->
		<type>gain</type>
		<input>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
			<value>0</value>
		</input>
		<input>
			<expression>
				<sum>
					<product>
						<property>/sim/fgcamera/view-adjustment/rotated/z-velocity</property>
						<property alias="/params/state/delta-t"/>
					</product>
					<property>/sim/fgcamera/view-adjustment/raw/z-offset-m</property>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/view-adjustment/raw/z-offset-m</output>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<equals>
				<property alias="/params/camera-type"/>
				<value>2</value>
			</equals>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<rad2deg>
							<product>
								<property>/sim/fgcamera/view-adjustment/rotated/z-velocity</property>
								<property>/world-camera/velocity-scale</property>
							</product>
						</rad2deg>
						<property>/sim/time/delta-realtime-sec</property>
						<value>-1</value>
					</product>
					<property alias="/params/adjustment/raw/lat"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/adjustment/raw/lat"/>
	</filter>



	<filter>
		<!--
			raw field of view
		-->
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<product>
						<product>
							<property>/sim/fgcamera/view-adjustment/raw/fov-velocity</property>
							<property alias="/params/adjustment/v-angular"/>
						</product>
						<property>/sim/time/delta-realtime-sec</property>
					</product>
					<property alias="/params/adjustment/raw/fov"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/adjustment/raw/fov"/>
	</filter>

	<filter>
		<!--
			raw heading-offset-deg
		-->
		<type>gain</type>
		<input> <!-- del? -->
			<condition>
				<property>/fgcam/look-at1</property>
			</condition>
			<expression>
				<rad2deg>
					<atan2>	
						<!--property>/sim/current-view/x-offset-m</property>
						<property>/sim/current-view/z-offset-m</property-->
						<property alias="/params/movement/raw/x"/>
						<property alias="/params/movement/raw/z"/>
					</atan2>
				</rad2deg>
			</expression>
		</input>
		<input>
			<expression>
				<sum>
					<product>
						<product>
							<property>/sim/fgcamera/view-adjustment/raw/h-velocity</property>
							<property alias="/params/adjustment/v-angular"/>
						</product>
						<property>/sim/time/delta-realtime-sec</property>
					</product>
					<property alias="/params/adjustment/raw/h"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/adjustment/raw/h"/>
	</filter>

	<filter>
		<!--
			raw pitch-offset-deg
		-->
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<product>
						<product>
							<property>/sim/fgcamera/view-adjustment/raw/p-velocity</property>
							<property alias="/params/adjustment/v-angular"/>
						</product>
						<property>/sim/time/delta-realtime-sec</property>
					</product>
					<property alias="/params/adjustment/raw/p"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/adjustment/raw/p"/>
	</filter>

	<filter>
		<!--
			raw roll-offset-deg
		-->
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<product>
						<product>
							<property>/sim/fgcamera/view-adjustment/raw/r-velocity</property>
							<property alias="/params/adjustment/v-angular"/>
						</product>
						<property>/sim/time/delta-realtime-sec</property>
					</product>
					<property alias="/params/adjustment/raw/r"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/adjustment/raw/r"/>
	</filter>

<!--
	Filter adjustment outputs:
-->
	<filter>
		<!--
			filter field of view
		-->
		<type>exponential</type>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property>/sim/fgcamera/view-adjustment/raw/fov-deg</property>
		</input>
		<output>/sim/fgcamera/view-adjustment/fov-deg</output>
	</filter>


	<filter>
		<!--
			filter heading-offset-deg
		-->
		<type>exponential</type>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property>/sim/fgcamera/view-adjustment/raw/heading-offset-deg</property>
		</input>
		<output>/sim/fgcamera/view-adjustment/heading-offset-deg</output>
	</filter>

	<filter>
		<!--
			filter pitch-offset-deg
		-->
		<type>exponential</type>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property>/sim/fgcamera/view-adjustment/raw/pitch-offset-deg</property>
		</input>
		<output>/sim/fgcamera/view-adjustment/pitch-offset-deg</output>
	</filter>

	<filter>
		<!--
			filter roll-offset-deg
		-->
		<type>exponential</type>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property>/sim/fgcamera/view-adjustment/raw/roll-offset-deg</property>
		</input>
		<output>/sim/fgcamera/view-adjustment/roll-offset-deg</output>
	</filter>

	<filter>
		<!--
			filter x-offset-m
		-->
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property>/sim/fgcamera/view-adjustment/raw/x-offset-m</property>
		</input>
		<output>/sim/fgcamera/view-adjustment/x-offset-m</output>
	</filter>

	<filter>
		<!--
			filter y-offset-m
		-->
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property>/sim/fgcamera/view-adjustment/raw/y-offset-m</property>
		</input>
		<output>/sim/fgcamera/view-adjustment/y-offset-m</output>
	</filter>

	<filter>
		<!--
			filter z-offset-m
		-->
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property>/sim/fgcamera/view-adjustment/raw/z-offset-m</property>
		</input>
		<output>/sim/fgcamera/view-adjustment/z-offset-m</output>
	</filter>


	<filter>
		<!--
			filter longitude-deg
			("world camera")
		-->
		<type>exponential</type>
		<enable>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
		</enable>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property alias="/params/adjustment/raw/lon"/>
		</input>
		<output alias="/params/adjustment/lon"/>
	</filter>

	<filter>
		<!--
			filter altitude-ft
			("world camera")
		-->
		<type>exponential</type>
		<enable>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
		</enable>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property alias="/params/adjustment/raw/alt"/>
		</input>
		<output alias="/params/adjustment/alt"/>
	</filter>

	<filter>
		<!--
			filter latitude-deg
			("world camera")
		-->
		<type>exponential</type>
		<enable>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
		</enable>
		<filter-time>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/adjustment/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<value>0</value>
		</input>
		<input>
			<property alias="/params/adjustment/raw/lat"/>
		</input>
		<output alias="/params/adjustment/lat"/>
	</filter>

<!--
===================================================================================================
	View Movement

		1. ...
		2. ...
		3. ...
===================================================================================================
-->

<!--
	Select view:
-->
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<not-equals>
					<property alias="/params/view-number"/>
					<property>/sim/current-view/view-number</property>
				</not-equals>
			</condition>
		</enable>
		<input>1</input>
		<output alias="/params/movement/snap"/>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<not-equals>
					<property alias="/params/view-number"/>
					<property>/sim/current-view/view-number</property>
				</not-equals>
			</condition>
		</enable>
		<input alias="/params/view-number"/>
		<output>/sim/current-view/view-number</output>
	</filter>


	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property alias="/params/state/start-moving"/>
				<less-than-equals>
					<property alias="/params/movement/movement-time"/>
					<value>0</value>
				</less-than-equals>
			</condition>
		</enable>
		<input>1</input>
		<output alias="/params/movement/snap"/>
	</filter>
<!--
	Set "From":
-->
	<filter>
		<!-- headtracker scale -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property>/sim/fgcamera/current-camera/config/head-tracker/enabled</property>
		</input>
		<input>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</input>
		<output>
			<property>/fgcam/head-tracker-scale-from</property>
		</output>
	</filter>

	<filter>
		<!-- FOV -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/fov"/>
		</input>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[6]</property>
					<difference>
						<property alias="/params/movement/raw/fov"/>
						<property alias="/params/movement/fov"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/fov"/>
	</filter>


	<filter>
		<!-- heading -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/h"/>
		</input>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[3]</property>
					<difference>
						<property alias="/params/movement/raw/h"/>
						<property alias="/params/movement/h"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/h"/>
	</filter>

	<filter>
		<!-- pitch -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/p"/>
		</input>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[4]</property>
					<difference>
						<property alias="/params/movement/raw/p"/>
						<property alias="/params/movement/p"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/p"/>
	</filter>

	<filter>
		<!-- roll -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/p"/>
		</input>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[5]</property>
					<difference>
						<property alias="/params/movement/raw/r"/>
						<property alias="/params/movement/r"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/r"/>
	</filter>

	<filter>
		<!-- x -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[0]</property>
					<difference>
						<property alias="/params/movement/raw/x"/>
						<property alias="/params/movement/x"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/x"/>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/current-camera/latitude-deg</property>
					<difference>
						<property alias="/params/movement/raw/lat"/>
						<property alias="/params/movement/lat"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/lat"/>
	</filter>

	<filter>
		<!-- y -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/y"/>
		</input>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[1]</property>
					<difference>
						<property alias="/params/movement/raw/y"/>
						<property alias="/params/movement/y"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/y"/>
	</filter>
	<filter>
		<!-- altitude -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/alt"/>
		</input>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/current-camera/altitude-ft</property>
					<difference>
						<property alias="/params/movement/raw/alt"/>
						<property alias="/params/movement/alt"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/alt"/>
	</filter>

	<filter>
		<!-- z -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/z"/>
		</input>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[2]</property>
					<difference>
						<property alias="/params/movement/raw/z"/>
						<property alias="/params/movement/z"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/z"/>
	</filter>
	<filter>
		<!-- longitude -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/lon"/>
		</input>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/current-camera/longitude-deg</property>
					<difference>
						<property alias="/params/movement/raw/lon"/>
						<property alias="/params/movement/lon"/>
					</difference>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/from/lon"/>
	</filter>

<!--
	Set "To":
-->
	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<property>/sim/fgcamera/current-camera/config/head-tracker/enabled</property>
		</input>
		<output>
			<property>/fgcam/head-tracker-scale-to</property>
		</output>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input alias="/params/movement/cfg/fov"/>
		<output alias="/params/movement/to/fov"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input alias="/params/movement/cfg/h"/>
		<output alias="/params/movement/to/h"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input alias="/params/movement/cfg/p"/>
		<output alias="/params/movement/to/p"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input alias="/params/movement/cfg/r"/>
		<output alias="/params/movement/to/r"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input alias="/params/movement/cfg/x"/>
		<output alias="/params/movement/to/x"/>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input alias="/params/movement/cfg/lat"/>
		<output alias="/params/movement/to/lat"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input alias="/params/movement/cfg/y"/>
		<output alias="/params/movement/to/y"/>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input alias="/params/movement/cfg/alt"/>
		<output alias="/params/movement/to/alt"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input alias="/params/movement/cfg/z"/>
		<output alias="/params/movement/to/z"/>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input alias="/params/movement/cfg/lon"/>
		<output alias="/params/movement/to/lon"/>
	</filter>

<!--
	Calculate delta:
-->
	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<expression>
				<difference>
					<property>/fgcam/head-tracker-scale-to</property>
					<property>/fgcam/head-tracker-scale-from</property>
				</difference>
			</expression>
		</input>
		<output>
			<property>/fgcam/head-tracker-scale-delta</property>
		</output>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/fov"/>
					<property alias="/params/movement/from/fov"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/fov"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/h"/>
					<property alias="/params/movement/from/h"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/h"/>
		<period>
			<min>-180</min>
			<max>180</max>
		</period>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/p"/>
					<property alias="/params/movement/from/p"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/p"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/r"/>
					<property alias="/params/movement/from/r"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/r"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/x"/>
					<property alias="/params/movement/from/x"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/x"/>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/lat"/>
					<property alias="/params/movement/from/lat"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/lat"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/y"/>
					<property alias="/params/movement/from/y"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/y"/>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/alt"/>
					<property alias="/params/movement/from/alt"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/alt"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/z"/>
					<property alias="/params/movement/from/z"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/z"/>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/start-moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<difference>
					<property alias="/params/movement/to/lon"/>
					<property alias="/params/movement/from/lon"/>
				</difference>
			</expression>
		</input>
		<output alias="/params/movement/delta/lon"/>
	</filter>

<!--
	view-adjustment-raw = 0
	mouse-look-raw = 0
-->
	<filter>
		<type>gain</type>
		<gain>0</gain>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<output alias="/params/adjustment/raw/lat"/>
		<output alias="/params/adjustment/raw/lon"/>
		<output alias="/params/adjustment/raw/alt"/>
		<output alias="/params/adjustment/raw/x"/>
		<output alias="/params/adjustment/raw/y"/>
		<output alias="/params/adjustment/raw/z"/>
		<!--output alias="/params/adjustment/raw/h"/-->
		<output alias="/params/adjustment/raw/fov"/>
		<output alias="/params/adjustment/raw/p"/>
		<output alias="/params/adjustment/raw/r"/>
		<output alias="/params/mlook/raw/h"/>
		<output alias="/params/mlook/raw/p"/>
	</filter>
	<filter>
		<type>gain</type>
		<gain>0</gain>
		<enable>
			<condition>
				<property alias="/params/state/start-moving"/>
				<not>
					<property>/fgcam/look-at1</property>
				</not>
			</condition>
		</enable>
		<output alias="/params/adjustment/raw/h"/>
	</filter>

<!--
	Calculate blend:
-->
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property alias="/params/state/moving"/>
				<not>
					<property alias="/params/movement/snap"/>
				</not>
			</condition>
		</enable>
		<input>
			<expression>
				<product>
					<property alias="/params/movement/elapsed-time"/>
					<pow>
						<property alias="/params/movement/movement-time"/>
						<value>-1</value>
					</pow>
				</product>
			</expression>
		</input>
		<output alias="/params/movement/blend"/>
		<max>1</max>
	</filter>

	<filter>
		<!--
			if (snap and moving)
				blend = 1;
		-->
		<type>gain</type>
		<enable>
			<condition>
				<!--property alias="/params/state/moving"/-->
				<property alias="/params/movement/snap"/>
			</condition>
		</enable>
		<input>
			<value>1</value>
		</input>
		<output alias="/params/movement/blend"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property alias="/params/state/moving"/>
				<not>
					<property alias="/params/movement/linterp"/>
				</not>
			</condition>
		</enable>
		<input>
			<expression>
				<table>
					<property alias="/params/movement/blend"/>
					<entry><ind>0.00000</ind> <dep>0.00000</dep></entry>
					<entry><ind>0.12574</ind> <dep>0.02989</dep></entry>
					<entry><ind>0.22592</ind> <dep>0.10592</dep></entry>
					<entry><ind>0.30798</ind> <dep>0.21663</dep></entry>
					<entry><ind>0.37936</ind> <dep>0.35056</dep></entry>
					<entry><ind>0.44750</ind> <dep>0.49625</dep></entry>
					<entry><ind>0.51984</ind> <dep>0.64224</dep></entry>
					<entry><ind>0.60382</ind> <dep>0.77707</dep></entry>
					<entry><ind>0.70688</ind> <dep>0.88928</dep></entry>
					<entry><ind>0.83646</ind> <dep>0.96741</dep></entry>
					<entry><ind>1.00000</ind> <dep>1.00000</dep></entry>
				</table>
			</expression>
		</input>
		<output alias="/params/movement/blend"/>
		<max>1</max>
	</filter>


<!--
	calculate raw movement offsets
-->
	<filter>
		<!-- headtracker scale -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/moving"/>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property>/fgcam/head-tracker-scale-delta</property>
					</product>
					<property>/fgcam/head-tracker-scale-from</property>
				</sum>
			</expression>
		</input>
		<output>
			<property>/sim/fgcamera/current-camera/head-tracker-scale-raw</property>
		</output>
	</filter>

	<filter>
		<!-- FOV -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/moving"/>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/fov"/>
					</product>
					<property alias="/params/movement/from/fov"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/fov"/>
	</filter>

	<filter>
		<!-- heading -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/moving"/>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/h"/>
					</product>
					<property alias="/params/movement/from/h"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/h"/>
	</filter>

	<filter>
		<!-- pitch -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/moving"/>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/p"/>
					</product>
					<property alias="/params/movement/from/p"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/p"/>
	</filter>

	<filter>
		<!-- roll -->
		<type>gain</type>
		<enable>
			<property alias="/params/state/moving"/>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/r"/>
					</product>
					<property alias="/params/movement/from/r"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/r"/>
	</filter>

	<filter>
		<!-- x -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/x"/>
					</product>
					<property alias="/params/movement/from/x"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/x"/>
	</filter>
	<filter>
		<!-- latitude -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/lat"/>
					</product>
					<property alias="/params/movement/from/lat"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/lat"/>
	</filter>

	<filter>
		<!-- y -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/y"/>
					</product>
					<property alias="/params/movement/from/y"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/y"/>
	</filter>
	<filter>
		<!-- altitude -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/alt"/>
					</product>
					<property alias="/params/movement/from/alt"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/alt"/>
	</filter>

	<filter>
		<!-- z -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/moving"/>
					<not-equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</not-equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/z"/>
					</product>
					<property alias="/params/movement/from/z"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/z"/>
	</filter>
	<filter>
		<!-- longitude -->
		<type>gain</type>
		<enable>
			<condition>
				<and>
					<property alias="/params/state/moving"/>
					<equals>
						<property alias="/params/camera-type"/>
						<value>2</value>
					</equals>
				</and>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<product>
						<property alias="/params/movement/blend"/>
						<property alias="/params/movement/delta/lon"/>
					</product>
					<property alias="/params/movement/from/lon"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/raw/lon"/>
	</filter>

	<filter>
		<!--
			Calculate t += dt
		-->
		<type>gain</type>
		<gain>1</gain>
		<enable>
			<property alias="/params/state/moving"/>
		</enable>
		<input>
			<expression>
				<sum>
					<property alias="/params/movement/elapsed-time"/>
					<property alias="/params/state/delta-t"/>
				</sum>
			</expression>
		</input>
		<output alias="/params/movement/elapsed-time"/>
	</filter>
<!--
	Filter movement output, set filters:
-->
	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property>/sim/fgcamera/current-camera/config/head-tracker/enabled</property>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</input>
		<input>
			<property>/sim/fgcamera/current-camera/head-tracker-scale-raw</property>
		</input>
		<output>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</output>
	</filter>


	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/fov"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/offsets[6]</property>
		</input>
		<input alias="/params/movement/raw/fov"/>
		<output alias="/params/movement/fov"/>
	</filter>

	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/h"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/offsets[3]</property>
		</input>
		<input alias="/params/movement/raw/h"/>
		<output alias="/params/movement/h"/>
	</filter>

	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/p"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/offsets[4]</property>
		</input>
		<input alias="/params/movement/raw/p"/>
		<output alias="/params/movement/p"/>
	</filter>

	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/r"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/offsets[5]</property>
		</input>
		<input alias="/params/movement/raw/r"/>
		<output alias="/params/movement/r"/>
	</filter>

	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/x"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/offsets[0]</property>
		</input>
		<input alias="/params/movement/raw/x"/>
		<output alias="/params/movement/x"/>
	</filter>
	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/lat"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/current-camera/latitude-deg</property>
		</input>
		<input alias="/params/movement/raw/lat"/>
		<output alias="/params/movement/lat"/>
	</filter>

	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0.0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/y"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/offsets[1]</property>
		</input>
		<input alias="/params/movement/raw/y"/>
		<output alias="/params/movement/y"/>
	</filter>
	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0.0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/alt"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/current-camera/altitude-ft</property>
		</input>
		<input alias="/params/movement/raw/alt"/>
		<output alias="/params/movement/alt"/>
	</filter>

	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/z"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/offsets[2]</property>
		</input>
		<input alias="/params/movement/raw/z"/>
		<output alias="/params/movement/z"/>
	</filter>
	<filter>
		<type>exponential</type>
		<filter-time>
			<condition>
				<or>
					<property alias="/params/state/start-moving"/>
					<property alias="/params/movement/snap"/>
				</or>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property alias="/params/movement/filter"/>
		</filter-time>
		<input>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<property alias="/params/movement/cfg/lon"/>
		</input>
		<input>
			<condition>
				<property alias="/params/state/start-moving"/>
			</condition>
			<property>/sim/fgcamera/current-camera/longitude-deg</property>
		</input>
		<input alias="/params/movement/raw/lon"/>
		<output alias="/params/movement/lon"/>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property alias="/params/state/moving"/>
				<greater-than-equals>
					<property alias="/params/movement/blend"/>
					<value>0.999</value>
				</greater-than-equals>
			</condition>
		</enable>
		<input>0</input>
		<output alias="/params/state/moving"/>
	</filter>


<!-- Reset headtracker values -->
	<filter>
		<type>gain</type>
		<update-interval-secs>1.0</update-interval-secs>
		<input>1</input>
		<output>/fgcam/update_trackir_status</output>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property>/fgcam/update_trackir_status</property>
				<equals>
					<property>/sim/TrackIR/heading-deg</property>
					<property>/sim/TrackIR/heading-deg-prev</property>
				</equals>
				<equals>
					<property>/sim/TrackIR/pitch-deg</property>
					<property>/sim/TrackIR/pitch-deg-prev</property>
				</equals>
				<equals>
					<property>/sim/TrackIR/roll-deg</property>
					<property>/sim/TrackIR/roll-deg-prev</property>
				</equals>
				<equals>
					<property>/sim/TrackIR/x-m</property>
					<property>/sim/TrackIR/x-m-prev</property>
				</equals>
				<equals>
					<property>/sim/TrackIR/y-m</property>
					<property>/sim/TrackIR/y-m-prev</property>
				</equals>
				<equals>
					<property>/sim/TrackIR/z-m</property>
					<property>/sim/TrackIR/z-m-prev</property>
				</equals>
			</condition>
		</enable>
		<input>0</input>
		<output>/sim/TrackIR/heading-deg</output>
		<output>/sim/TrackIR/pitch-deg</output>
		<output>/sim/TrackIR/roll-deg</output>
		<output>/sim/TrackIR/x-m</output>
		<output>/sim/TrackIR/y-m</output>
		<output>/sim/TrackIR/z-m</output>
	</filter>


	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property>/fgcam/update_trackir_status</property>
			</condition>
		</enable>
		<input>/sim/TrackIR/heading-deg</input>
		<output>/sim/TrackIR/heading-deg-prev</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property>/fgcam/update_trackir_status</property>
			</condition>
		</enable>
		<input>/sim/TrackIR/pitch-deg</input>
		<output>/sim/TrackIR/pitch-deg-prev</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property>/fgcam/update_trackir_status</property>
			</condition>
		</enable>
		<input>/sim/TrackIR/roll-deg</input>
		<output>/sim/TrackIR/roll-deg-prev</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property>/fgcam/update_trackir_status</property>
			</condition>
		</enable>
		<input>/sim/TrackIR/x-m</input>
		<output>/sim/TrackIR/x-m-prev</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property>/fgcam/update_trackir_status</property>
			</condition>
		</enable>
		<input>/sim/TrackIR/y-m</input>
		<output>/sim/TrackIR/y-m-prev</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property>/fgcam/update_trackir_status</property>
			</condition>
		</enable>
		<input>/sim/TrackIR/z-m</input>
		<output>/sim/TrackIR/z-m-prev</output>
	</filter>

	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property>/fgcam/update_trackir_status</property>
			</condition>
		</enable>
		<input>0</input>
		<output>/fgcam/update_trackir_status</output>
	</filter>
<!-- /Reset headtracker values -->




	<filter>
		<type>exponential</type>
		<gain>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</gain>
		<filter-time>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property>/sim/fgcamera/current-camera/config/head-tracker/filter-time</property>
		</filter-time>
		<input>
			<!--condition>
				<property>/sim/fgcamera/current-camera/config/head-tracker/enabled</property>
			</condition-->
			<property>/sim/TrackIR/heading-deg</property>
		</input>
		<!--input>0</input-->
		<output>
			<property>/fgcam/tir-h</property>
		</output>
	</filter>
	<filter>
		<type>exponential</type>
		<gain>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</gain>
		<filter-time>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property>/sim/fgcamera/current-camera/config/head-tracker/filter-time</property>
		</filter-time>
		<input>
			<property>/sim/TrackIR/pitch-deg</property>
		</input>
		<output>
			<property>/fgcam/tir-p</property>
		</output>
	</filter>
	<filter>
		<type>exponential</type>
		<gain>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</gain>
		<filter-time>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property>/sim/fgcamera/current-camera/config/head-tracker/filter-time</property>
		</filter-time>
		<input>
			<property>/sim/TrackIR/roll-deg</property>
		</input>
		<output>
			<property>/fgcam/tir-r</property>
		</output>
	</filter>
	<filter>
		<type>exponential</type>
		<gain>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</gain>
		<filter-time>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property>/sim/fgcamera/current-camera/config/head-tracker/filter-time</property>
		</filter-time>
		<input>
			<property>/sim/TrackIR/x-m</property>
		</input>
		<output>
			<property>/fgcam/tir-x</property>
		</output>
	</filter>
	<filter>
		<type>exponential</type>
		<gain>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</gain>
		<filter-time>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property>/sim/fgcamera/current-camera/config/head-tracker/filter-time</property>
		</filter-time>
		<input>
			<property>/sim/TrackIR/y-m</property>
		</input>
		<output>
			<property>/fgcam/tir-y</property>
		</output>
	</filter>
	<filter>
		<type>exponential</type>
		<gain>
			<property>/sim/fgcamera/current-camera/head-tracker-scale</property>
		</gain>
		<filter-time>
			<condition>
				<property alias="/params/movement/snap"/>
			</condition>
			<value>0</value>
		</filter-time>
		<filter-time>
			<property>/sim/fgcamera/current-camera/config/head-tracker/filter-time</property>
		</filter-time>
		<input>
			<property>/sim/TrackIR/z-m</property>
		</input>
		<output>
			<property>/fgcam/tir-z</property>
		</output>
	</filter>





	<logic>
		<!--
			if (start_moving)
				start_moving = !start_moving;
		-->
		<inverted>true</inverted>
		<enable>
			<property alias="/params/state/start-moving"/>
		</enable>
		<input>
			<property alias="/params/state/start-moving"/>
		</input>
		<output alias="/params/state/start-moving"/>
	</logic>

	<logic>
	<!--
		if (snap)
			snap = !snap;
	-->
		<inverted>true</inverted>
		<enable>
			<property alias="/params/movement/snap"/>
		</enable>
		<input>
			<property alias="/params/movement/snap"/>
		</input>
		<output alias="/params/movement/snap"/>
	</logic>

	<filter>
		<type>gain</type>
		<enable>
			<property alias="/params/lookat"/>
		</enable>
		<input>
			<expression>
				<rad2deg>
					<atan2>
						<sum>
							<property alias="/params/movement/x"/>
							<property alias="/params/adjustment/x"/>
						</sum>
						<sum>
							<property alias="/params/movement/z"/>
							<property alias="/params/adjustment/z"/>
						</sum>
					</atan2>
				</rad2deg>
			</expression>
		</input>
		<output>/fgcam/h</output>
	</filter>

	<filter> <!-- revise expressions! -->
		<type>gain</type>
		<enable>
			<property alias="/params/lookat"/>
		</enable>
		<input>
			<expression>
				<rad2deg>
					<atan2>
						<product>
							<sum>
								<property alias="/params/movement/y"/>
								<property alias="/params/adjustment/y"/>
							</sum>
							<value>-1</value>
						</product>
						<sqrt>
							<sum>
								<sqr>
									<sum>
										<property alias="/params/movement/z"/>
										<property alias="/params/adjustment/z"/>
									</sum>
								</sqr>
								<sqr>
									<sum>
										<property alias="/params/movement/x"/>
										<property alias="/params/adjustment/x"/>
									</sum>
								</sqr>
							</sum>
						</sqrt>
					</atan2>
				</rad2deg>
			</expression>
		</input>
		<output>/fgcam/p</output>
		<period>
			<min>-90</min>
			<max>90</max>
		</period>
	</filter>





<!--
===================================================================================================
	Offsets
===================================================================================================
-->
	<filter>
		<type>gain</type>
		<input>
			<condition>
				<property alias="/params/lookat"/>
			</condition>
			<expression>
				<sum>
					<property alias="/params/mlook/h"/>
					<property>/fgcam/h</property>
				</sum>
			</expression>
		</input>
		<input>
			<expression>
				<sum>
					<property alias="/params/mlook/h"/>
					<property alias="/params/adjustment/h"/>
					<property alias="/params/movement/h"/>
					<product>
						<sum>
							<property alias="/params/cr/h"/>
							<property alias="/params/ext/h"/>
							<property>/sim/fgcamera/effects/RND-main/mixer/h-output</property>
						</sum>
						<property alias="/params/movement/blend"/>
					</product>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/offsets[3]</output>
		<period>
			<min>-180</min>
			<max>180</max>
		</period>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<condition>
				<property alias="/params/lookat"/>
			</condition>
			<expression>
				<sum>
					<property alias="/params/mlook/p"/>
					<property>/fgcam/p</property>
				</sum>
			</expression>
		</input>
		<input>
			<expression>
				<sum>
					<property alias="/params/mlook/p"/>
					<property alias="/params/adjustment/p"/>
					<property alias="/params/movement/p"/>
					<product>
						<sum>
							<property alias="/params/dhm/p"/>
							<property alias="/params/cr/p"/>
							<property>/sim/fgcamera/effects/RND-main/mixer/p-output</property>
						</sum>
						<property alias="/params/movement/blend"/>
					</product>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/offsets[4]</output>
		<min>-90</min>
		<max>90</max>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property alias="/params/adjustment/r"/>
					<property alias="/params/movement/r"/>
					<product>
						<sum>
							<property alias="/params/dhm/r"/>
							<property>/sim/fgcamera/effects/RND-main/mixer/r-output</property>
						</sum>
						<property alias="/params/movement/blend"/>
					</product>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/offsets[5]</output>
		<min>-90</min>
		<max>90</max>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<condition>
				<not-equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</not-equals>
			</condition>
			<expression>
				<sum>
					<property alias="/params/adjustment/x"/>
					<property alias="/params/movement/x"/>
					<product>
						<sum>
							<property alias="/params/dhm/x"/>
							<property>/sim/fgcamera/effects/power-plant-vibration/x-offset-m</property>
							<property>/sim/fgcamera/effects/RND-main/mixer/x-output</property>
						</sum>
						<property alias="/params/movement/blend"/>
					</product>
				</sum>
			</expression>
		</input>
		<input>0</input>
		<output>/sim/fgcamera/offsets[0]</output>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<condition>
				<not-equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</not-equals>
			</condition>
			<expression>
				<sum>
					<property alias="/params/adjustment/y"/>
					<property alias="/params/movement/y"/>
					<product>
						<sum>
							<property alias="/params/dhm/y"/>
							<property>/fgcam/dhm/output</property>
							<property>/sim/fgcamera/effects/power-plant-vibration/y-offset-m</property>
							<property>/fgcam/buffeting/output</property>
							<property>/sim/fgcamera/effects/RND-main/mixer/y-output</property>
						</sum>
						<property alias="/params/movement/blend"/>
					</product>
				</sum>
			</expression>
		</input>
		<input>0</input>
		<output>/sim/fgcamera/offsets[1]</output>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<condition>
				<not-equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</not-equals>
			</condition>
			<expression>
				<sum>
					<property alias="/params/adjustment/z"/>
					<property alias="/params/movement/z"/>
					<product>
						<sum>
							<property alias="/params/dhm/z"/>
							<property>/sim/fgcamera/effects/power-plant-vibration/z-offset-m</property>
							<property>/sim/fgcamera/effects/RND-main/mixer/z-output</property>
						</sum>
						<property alias="/params/movement/blend"/>
					</product>
				</sum>
			</expression>
		</input>
		<input>0</input>
		<output>/sim/fgcamera/offsets[2]</output>
	</filter>



<!--
===================================================================================================
	Offsets2
===================================================================================================
-->






<!--
===================================================================================================
	Apply offsets
===================================================================================================
-->
	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[3]</property>
					<property>/fgcam/tir-h</property>
				</sum>
			</expression>
		</input>
		<output>/sim/current-view/heading-offset-deg</output>
		<period>
			<min>-180</min>
			<max>180</max>
		</period>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[4]</property>
					<property>/fgcam/tir-p</property>
				</sum>
			</expression>
		</input>
		<output>/sim/current-view/pitch-offset-deg</output>
		<min>-90</min>
		<max>90</max>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[5]</property>
					<property>/fgcam/tir-r</property>
				</sum>
			</expression>
		</input>
		<output>/sim/current-view/roll-offset-deg</output>
		<min>-90</min>
		<max>90</max>
	</filter>

<!-- x -->
	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[0]</property>
					<property>/fgcam/tir-x</property>
				</sum>
			</expression>
		</input>
		<output>/sim/current-view/x-offset-m</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<property alias="/params/adjustment/lat"/>
					<property alias="/params/movement/lat"/>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/current-camera/latitude-deg</output>
	</filter>


	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[1]</property>
					<property>/fgcam/tir-y</property>
				</sum>
			</expression>
		</input>
		<output>/sim/current-view/y-offset-m</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<property alias="/params/adjustment/alt"/>
					<property alias="/params/movement/alt"/>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/current-camera/altitude-ft</output>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property>/sim/fgcamera/offsets[2]</property>
					<property>/fgcam/tir-z</property>
				</sum>
			</expression>
		</input>
		<output>/sim/current-view/z-offset-m</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<equals>
					<property alias="/params/camera-type"/>
					<value>2</value>
				</equals>
			</condition>
		</enable>
		<input>
			<expression>
				<sum>
					<property alias="/params/adjustment/lon"/>
					<property alias="/params/movement/lon"/>
				</sum>
			</expression>
		</input>
		<output>/sim/fgcamera/current-camera/longitude-deg</output>
	</filter>

	<filter>
		<type>gain</type>
		<input>
			<expression>
				<sum>
					<property alias="/params/adjustment/fov"/>
					<property alias="/params/movement/fov"/>
				</sum>
			</expression>
		</input>
		<output>/sim/current-view/field-of-view</output>
		<output>/sim/fgcamera/offsets[6]</output>
		<min>1</min>
		<max>135</max>
	</filter>


	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property alias="/params/movement/chained"/>
				<not>
					<property alias="/params/state/moving"/>
				</not>
				<not>
					<property>/sim/fgcamera/gui-opened</property>
				</not>
			</condition>
		</enable>
		<input>1</input>
		<output>/fgcam/next-in-category</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property alias="/params/dialog-show"/>
				<not>
					<property>/sim/fgcamera/current-camera/dialog-opened</property>
				</not>
				<not>
					<property alias="/params/state/moving"/>
				</not>
				<not>
					<property>/sim/fgcamera/gui-opened</property>
				</not>
			</condition>
		</enable>
		<input>1</input>
		<output>/fgcam/dialog-show</output>
	</filter>
	<filter>
		<type>gain</type>
		<enable>
			<condition>
				<property alias="/params/panel-show"/>
				<not>
					<property>/sim/fgcamera/current-camera/panel-opened</property>
				</not>
				<not>
					<property alias="/params/state/moving"/>
				</not>
				<not>
					<property>/sim/fgcamera/gui-opened</property>
				</not>
			</condition>
		</enable>
		<input>1</input>
		<output>/fgcam/panel-show</output>
	</filter>
	<!--filter>
		<type>gain</type>
		<enable>
			<condition>
				<not>
					<property alias="/params/state/moving"/>
				</not>
				<not>
					<property>/sim/fgcamera/current-camera/cursor-group-selected</property>
				</not>
			</condition>
		</enable>
		<input>1</input>
		<output>/fgcam/select-cursor-group</output>
	</filter-->
</PropertyList>